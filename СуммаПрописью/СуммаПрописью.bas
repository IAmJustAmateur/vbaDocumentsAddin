Attribute VB_Name = "—уммаѕрописью"
#If Win64 Then
Public Function —уммаѕрописью(src_num As LongLong) As String
#Else
Public Function —уммаѕрописью(src_num As Long) As String
#End If
    ' число прописью, дла неотрицательных чисел, <= 999 999 999 999

    Dim Digits(15) As Long
    Dim wrd(15) As String
    Dim rez As String
    Dim inp_str As String
    Dim i, j, NumberOfDigits As Integer
            
    i = 0
    Do While (i <= 14) And (src_num > 0)
        Digits(i) = src_num Mod 10
        src_num = src_num \ 10
        i = i + 1
    Loop
    
    NumberOfDigits = i
    i = 0
    Do While i < NumberOfDigits
        If (i Mod 3 = 0) Then
            Select Case Digits(i)
                Case 0:
                    If i = 3 Then
                        If (Digits(4) <> 0) Or (Digits(5) <> 0) Then
                            wrd(i) = "тыс€ч"
                        Else
                            wrd(i) = ""
                        End If
                     ElseIf i = 6 Then
                        If (Digits(7) <> 0) Or (Digits(8) <> 0) Then
                            wrd(i) = "миллионов"
                        Else
                            wrd(i) = ""
                        End If
                    ElseIf i = 9 Then
                        If (Digits(10) <> 0) Or (Digits(11) <> 0) Then
                            wrd(i) = "миллиардов"
                        End If
                    ElseIf i = 12 Then
                        If (Digits(13) <> 0) Or (Digits(14) <> 0) Then
                            wrd(i) = "триллионов"
                        End If
                    Else
                         wrd(i) = ""
                    End If
                Case 1:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "одна тыс€ча"
                        ElseIf i = 6 Then
                            wrd(i) = "один миллион"
                        ElseIf i = 9 Then
                            wrd(i) = "один миллиард"
                        ElseIf i = 12 Then
                            wrd(i) = "один триллион"
                        Else
                            wrd(i) = "один"
                        End If
                    Else
                        Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 12: wrd(i) = "триллионов"
                        End Select
                    End If
                    
                Case 2:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "две тыс€чи"
                        ElseIf i = 6 Then
                            wrd(i) = "два миллиона"
                        ElseIf i = 9 Then
                            wrd(i) = "два миллиарда"
                        ElseIf i = 9 Then
                            wrd(i) = "два триллиона"
                        Else
                            wrd(i) = "два"
                        End If
                    Else
                    Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 12: wrd(i) = "триллионов"
                        End Select
                    End If
                Case 3:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "три тыс€чи"
                        ElseIf i = 6 Then
                            wrd(i) = "три миллиона"
                        ElseIf i = 9 Then
                            wrd(i) = "три миллиарда"
                        ElseIf i = 12 Then
                            wrd(i) = "три триллиона"
                        Else
                            wrd(i) = "три"
                        End If
                    Else
                        Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 12: wrd(i) = "триллионов"
                        End Select
                    End If
                Case 4:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "четыре тыс€чи"
                        ElseIf i = 6 Then
                            wrd(i) = "четыре миллиона"
                        ElseIf i = 9 Then
                            wrd(i) = "четыре миллиарда"
                        ElseIf i = 9 Then
                            wrd(i) = "четыре триллиона"
                        Else
                            wrd(i) = "четыре"
                        End If
                    Else
                        Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 12: wrd(i) = "триллионов"
                        End Select
                    End If
                Case 5:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "п€ть тыс€ч"
                        ElseIf i = 6 Then
                            wrd(i) = "п€ть миллионов"
                        ElseIf i = 9 Then
                            wrd(i) = "п€ть миллиардов"
                        ElseIf i = 9 Then
                            wrd(i) = "п€ть триллионов"
                        Else
                            wrd(i) = "п€ть"
                        End If
                    Else
                        Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 12: wrd(i) = "триллионов"
                        End Select
                    End If
                Case 6:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "шесть тыс€ч"
                        ElseIf i = 6 Then
                            wrd(i) = "шесть миллионов"
                        ElseIf i = 9 Then
                            wrd(i) = "шесть миллиардов"
                        ElseIf i = 12 Then
                            wrd(i) = "шесть триллионов"
                        Else
                            wrd(i) = "шесть"
                        End If
                     Else
                        Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 12: wrd(i) = "триллионов"
                        End Select
                    End If
                Case 7:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "семь тыс€ч"
                        ElseIf i = 6 Then
                            wrd(i) = "семь миллионов"
                        ElseIf i = 9 Then
                            wrd(i) = "семь миллиардов"
                         ElseIf i = 12 Then
                            wrd(i) = "семь триллионов"
                        Else
                            wrd(i) = "семь"
                        End If
                    Else
                        Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 9: wrd(i) = "триллионов"
                        End Select
                    End If
                Case 8:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "восемь тыс€ч"
                        ElseIf i = 6 Then
                            wrd(i) = "восемь миллионов"
                        ElseIf i = 9 Then
                            wrd(i) = "восемь миллиардов"
                        ElseIf i = 9 Then
                            wrd(i) = "восемь триллионов"
                        Else
                            wrd(i) = "восемь"
                        End If
                     Else
                        Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 12: wrd(i) = "триллионов"
                        End Select
                    End If
                Case 9:
                    If (Digits(i + 1) <> 1) Then
                        If i = 3 Then
                            wrd(i) = "дев€ть тыс€ч"
                            ElseIf i = 6 Then
                            wrd(i) = "дев€ть миллионов"
                        ElseIf i = 9 Then
                            wrd(i) = "дев€ть миллиардов"
                        ElseIf i = 12 Then
                            wrd(i) = "дев€ть триллионов"
                        Else
                            wrd(i) = "дев€ть"
                        End If
                    Else
                        Select Case i
                            Case 0: wrd(i) = ""
                            Case 3: wrd(i) = "тыс€ч"
                            Case 6: wrd(i) = "миллионов"
                            Case 9: wrd(i) = "миллиардов"
                            Case 12: wrd(i) = "триллионов"
                        End Select
                    End If
            End Select
        ElseIf (i Mod 3 = 1) Then
               Select Case Digits(i)
                Case 0: wrd(i) = ""
                Case 1:
                    If Digits(i - 1) = 0 Then
                        wrd(i) = "дес€ть"
                    Else
                        Select Case Digits(i - 1)
                            Case 1: wrd(i) = "одиннадцать"
                            Case 2: wrd(i) = "двенадцать"
                            Case 3: wrd(i) = "тринадцать"
                            Case 4: wrd(i) = "четырнадцать"
                            Case 5: wrd(i) = "п€тнадцать"
                            Case 6: wrd(i) = "шестнадцать"
                            Case 7: wrd(i) = "семнадцать"
                            Case 8: wrd(i) = "восемнадцать"
                            Case 9: wrd(i) = "дев€тнадцать"
                        End Select
                    End If
                Case 2: wrd(i) = "двадцать"
                Case 3: wrd(i) = "тридцать"
                            
                Case 4: wrd(i) = "сорок"
                            
                Case 5: wrd(i) = "п€тьдес€т"
                         
                Case 6: wrd(i) = "шестьдес€т"
                            
                Case 7: wrd(i) = "семьдес€т"
                           
                Case 8: wrd(i) = "восемьдес€т"
                Case 9: wrd(i) = "дев€носто"
                End Select
         ElseIf (i Mod 3 = 2) Then
               Select Case Digits(i)
                Case 0: wrd(i) = ""
                Case 1: wrd(i) = "сто"
                Case 2: wrd(i) = "двести"
                Case 3: wrd(i) = "триста"
                            
                Case 4: wrd(i) = "четыреста"
                            
                Case 5: wrd(i) = "п€тьсот"
                         
                Case 6: wrd(i) = "шестьсот"
                            
                Case 7: wrd(i) = "семьсот"
                           
                Case 8: wrd(i) = "восемьсот"
                Case 9: wrd(i) = "дев€тьсот"
                End Select
            End If
        i = i + 1
    Loop
    rez = ""
    For i = NumberOfDigits To 1 Step -1
        If (wrd(i - 1) <> "") Then
            rez = rez & " " & wrd(i - 1)
        End If
    Next i
    —уммаѕрописью = rez
End Function
Public Function —умма–ублейѕрописью(dsource As Currency, Optional bRub = False) As String
' bRub, если »стина (True), российские рубли
' ѕо умолчанию Ћожь(False), белорусские рубли
' если после зап€той более 2х знаков, производитс€ округление до копеек
' дл€ неотрицательных чисел, <= 999'999'999'999'999
#If Win64 Then
    Dim lWhole As LongLong
#Else
    Dim lWhole As Long
#End If
    Dim lFrac As Long
    Dim s As String
    Dim sRouble As String
    Dim sKop As String
    lWhole = Val(dsource)
    lFrac = CInt((dsource - lWhole) * 100)
    If ((lWhole Mod 100) > 10) And ((lWhole Mod 100) < 20) Then
        sRouble = " белорусских рублей"
    Else
        Select Case (lWhole Mod 10)
            Case 1: sRouble = " белорусский рубль"
            Case 2, 3, 4: sRouble = " белорусских рубл€"
            Case 5, 6, 7, 8, 9, 0: sRouble = " белорусских рублей"
        End Select
    End If
    
    If ((lFrac > 10) And (lFrac < 20)) Then
        sKop = " копеек"
    Else
        Select Case (lFrac Mod 10)
            Case 1: sKop = " копейка"
            Case 2, 3, 4: sKop = " копейки"
            Case 5, 6, 7, 8, 9, 0: sKop = " копеек"
        End Select
    End If
    If Len(CStr(lFrac)) = 1 Then
        sKop = "0" + CStr(lFrac) + sKop
    Else
        sKop = CStr(lFrac) + sKop
    End If
           
    s = —уммаѕрописью(lWhole) + sRouble + " " + sKop
    If bRub Then
        s = Replace(s, "белорусски", "российски", Start:=1, Compare:=vbTextCompare)
    End If
    —умма–ублейѕрописью = s

End Function
